class w{constructor(s){this.vals=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];s&&(this.vals=[...s])}static fromTranslation(s){return new w([1,0,0,0,0,1,0,0,0,0,1,0,s.x,s.y,s.z,1])}static fromRotation(s,n){const t=(s%360+360)%360,a=(t>180?t-360:t)*(Math.PI/180),l=Math.floor(1e4*Math.cos(a))/1e4,e=Math.floor(1e4*Math.sin(a))/1e4,c=1-l,{x:v,y:o,z:r}=typeof n=="string"?{x:+(n==="x"),y:+(n==="y"),z:+(n==="z")}:n,i=c*v,u=c*o;return new w([i*v+l,i*o-e*r,i*r+e*o,0,i*o+e*r,u*o+l,u*r-e*v,0,i*r-e*o,u*r+e*v,c*r*r+l,0,0,0,0,1])}static fromScale(s){return new w([s.x,0,0,0,0,s.y,0,0,0,0,s.z,0,0,0,0,1])}static fromRotationFlipOffset(s,n,t){const a=new w().rotate(s.y,"y").rotate(s.x,"x").rotate(s.z,"z").scale(n);if(!t)return a;const l=w.fromTranslation(t);return l.multiply(a).multiply(l.invert())}clone(){return new w(this.vals)}rotate(s,n){return w.fromRotation(s,n).multiply(this)}translate(s){return w.fromTranslation(s).multiply(this)}scale(s){return w.fromScale(s).multiply(this)}transpose(){const s=[...this.vals];return s[1]=this.vals[4],s[4]=this.vals[1],s[2]=this.vals[8],s[8]=this.vals[2],s[6]=this.vals[9],s[9]=this.vals[6],s[3]=this.vals[12],s[12]=this.vals[3],s[7]=this.vals[13],s[13]=this.vals[7],s[11]=this.vals[14],s[14]=this.vals[11],new w(s)}invert(){const s=[...this.vals],n=s[0],t=s[1],a=s[2],l=s[3],e=s[4],c=s[5],v=s[6],o=s[7],r=s[8],i=s[9],u=s[10],h=s[11],b=s[12],m=s[13],f=s[14],y=s[15],V=i*f*o-m*u*o+m*v*h-c*f*h-i*v*y+c*u*y,z=b*u*o-r*f*o-b*v*h+e*f*h+r*v*y-e*u*y,d=r*m*o-b*i*o+b*c*h-e*m*h-r*c*y+e*i*y,E=b*i*v-r*m*v-b*c*u+e*m*u+r*c*f-e*i*f,x=n*V+t*z+a*d+l*E;if(x===0)return new w([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);const p=1/x;return s[0]=V*p,s[1]=(m*u*l-i*f*l-m*a*h+t*f*h+i*a*y-t*u*y)*p,s[2]=(c*f*l-m*v*l+m*a*o-t*f*o-c*a*y+t*v*y)*p,s[3]=(i*v*l-c*u*l-i*a*o+t*u*o+c*a*h-t*v*h)*p,s[4]=z*p,s[5]=(r*f*l-b*u*l+b*a*h-n*f*h-r*a*y+n*u*y)*p,s[6]=(b*v*l-e*f*l-b*a*o+n*f*o+e*a*y-n*v*y)*p,s[7]=(e*u*l-r*v*l+r*a*o-n*u*o-e*a*h+n*v*h)*p,s[8]=d*p,s[9]=(b*i*l-r*m*l-b*t*h+n*m*h+r*t*y-n*i*y)*p,s[10]=(e*m*l-b*c*l+b*t*o-n*m*o-e*t*y+n*c*y)*p,s[11]=(r*c*l-e*i*l-r*t*o+n*i*o+e*t*h-n*c*h)*p,s[12]=E*p,s[13]=(r*m*a-b*i*a+b*t*u-n*m*u-r*t*f+n*i*f)*p,s[14]=(b*c*a-e*m*a-b*t*v+n*m*v+e*t*f-n*c*f)*p,s[15]=(e*i*a-r*c*a+r*t*v-n*i*v-e*t*u+n*c*u)*p,new w(s)}multiply(s){const n=new w,t=n.vals,a=this.vals[0],l=this.vals[4],e=this.vals[8],c=this.vals[12],v=this.vals[1],o=this.vals[5],r=this.vals[9],i=this.vals[13],u=this.vals[2],h=this.vals[6],b=this.vals[10],m=this.vals[14],f=this.vals[3],y=this.vals[7],V=this.vals[11],z=this.vals[15],d=s.vals[0],E=s.vals[4],x=s.vals[8],p=s.vals[12],N=s.vals[1],R=s.vals[5],T=s.vals[9],I=s.vals[13],S=s.vals[2],F=s.vals[6],O=s.vals[10],P=s.vals[14],g=s.vals[3],j=s.vals[7],k=s.vals[11],q=s.vals[15];return t[0]=a*d+l*N+e*S+c*g,t[4]=a*E+l*R+e*F+c*j,t[8]=a*x+l*T+e*O+c*k,t[12]=a*p+l*I+e*P+c*q,t[1]=v*d+o*N+r*S+i*g,t[5]=v*E+o*R+r*F+i*j,t[9]=v*x+o*T+r*O+i*k,t[13]=v*p+o*I+r*P+i*q,t[2]=u*d+h*N+b*S+m*g,t[6]=u*E+h*R+b*F+m*j,t[10]=u*x+h*T+b*O+m*k,t[14]=u*p+h*I+b*P+m*q,t[3]=f*d+y*N+V*S+z*g,t[7]=f*E+y*R+V*F+z*j,t[11]=f*x+y*T+V*O+z*k,t[15]=f*p+y*I+V*P+z*q,n}}export{w as Matrix};
