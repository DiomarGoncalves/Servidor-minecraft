import{everyCall as p,regionSize as u,Server as a,Vector as y}from"library/Minecraft.js";import{Tool as r}from"./base_tool.js";import{Tools as i}from"./tool_manager.js";import{CuboidShape as w}from"server/shapes/cuboid.js";const m=new WeakMap;class l extends r{use(e,o){typeof this.command=="string"?a.command.callCommand(e,this.command):a.command.callCommand(e,this.command[0],this.command.slice(1))}}class g extends l{constructor(){super(...arguments);this.command="cut";this.permission="worldedit.clipboard.cut"}}i.register(g,"cut","wedit:cut_button");class P extends l{constructor(){super(...arguments);this.command="copy";this.permission="worldedit.clipboard.copy"}}i.register(P,"copy","wedit:copy_button");class f extends l{constructor(){super(...arguments);this.command=["paste","-s"];this.permission="worldedit.clipboard.paste";this.outlines=new WeakMap;this.tick=d}use(o,n){a.command.callCommand(o,this.command[0],this.command.slice(1))}}i.register(f,"paste","wedit:paste_button");class b extends l{constructor(){super(...arguments);this.command="undo";this.permission="worldedit.history.undo"}}i.register(b,"undo","wedit:undo_button");class C extends l{constructor(){super(...arguments);this.command="redo";this.permission="worldedit.history.redo"}}i.register(C,"redo","wedit:redo_button");class S extends r{constructor(){super(...arguments);this.permission="worldedit.region.rotate";this.tick=d}use(o,n){const s=["90"];a.player.isSneaking(o)&&s.push("-o"),a.command.callCommand(o,"rotate",s)}}i.register(S,"rotate_cw","wedit:rotate_cw_button");class _ extends r{constructor(){super(...arguments);this.permission="worldedit.region.rotate";this.tick=d}use(o,n){const s=["-90"];a.player.isSneaking(o)&&s.push("-o"),a.command.callCommand(o,"rotate",s)}}i.register(_,"rotate_ccw","wedit:rotate_ccw_button");class h extends r{constructor(){super(...arguments);this.permission="worldedit.region.flip";this.tick=d}use(o,n){const s=[];a.player.isSneaking(o)&&s.push("-o"),a.command.callCommand(o,"flip",s)}}i.register(h,"flip","wedit:flip_button");class T extends r{use(e){a.queueCommand("setblock ~~~ glass",e)}}i.register(T,"spawn_glass","wedit:spawn_glass");class k extends r{use(e,o){o.enterSettings()}}i.register(k,"config","wedit:config_button");function*d(t,e){if(!e.clipboard||!e.drawOutlines)return;m.has(e)||m.set(e,{lazyCall:p(8)});const[o,n]=e.clipboard.getBounds(y.from(t.location).floor().add(.5),e.clipboardTransform),s=u(o,n),c=new w(...s.toArray());m.get(e).lazyCall(()=>c.draw(t,o)),yield}
