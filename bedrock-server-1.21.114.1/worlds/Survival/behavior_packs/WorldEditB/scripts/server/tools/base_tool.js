import{system as n}from"@minecraft/server";import{Server as P,Thread as k}from"library/Minecraft.js";import{printerr as u}from"../util.js";import{RawText as m}from"library/Minecraft.js";var S=(r=>(r.USE="use",r.USE_ON="useOn",r.BREAK="break",r.HIT="hit",r.DROP="drop",r.STOP_HOLD="stopHold",r))(S||{});class U{constructor(){this.noDelay=!1;this.onSurface=!1;this.useOnTick=0;this.lastUse=n.currentTick}process(s,l,c){const t=s.player,y=n.currentTick;if(!this[l])return!1;const r=e=>{u(e.message?m.text(`${e.name}: `).append("translate",e.message):e,t,!0),e.stack&&u(e.stack,t,!1)};return new k().start(function*(e,p,a,i,d){a.usingItem=!0;try{if(!P.player.hasPermission(p,e.permission))throw"worldedit.tool.noPerm";if((n.currentTick-e.lastUse>4||e.noDelay)&&(e.lastUse=n.currentTick,!(i=="use"&&e.useOnTick==y))){i=="useOn"&&(e.useOnTick=y);const o=e[i](p,a,d);typeof o?.next=="function"&&(yield*o)}}catch(o){r(o)}finally{a.usingItem=!1}},this,t,s,l,c),!0}delete(){}toJSON(){return{toolType:this.type}}static parseJSON(s){return[]}}export{U as Tool,S as ToolAction};
