import{RawText as p,regionSize as w}from"library/Minecraft.js";import{registerCommand as x}from"../register_commands.js";import{assertCuboidSelection as y}from"server/modules/assert.js";import{Pattern as h}from"server/modules/pattern.js";const z={name:"gradient",permission:"worldedit.generation.gradient",description:"commands.wedit:gradient.description",usage:[{subName:"create",args:[{flag:"s"},{flag:"f",name:"fade",type:"float",range:[0,1]},{name:"id",type:"string"},{name:"patterns",type:"Pattern...",default:[new h("stone")]}]},{subName:"delete",args:[{name:"id",type:"string"}]},{subName:"list"}]};function b(t,s){if(t.length<=s)return t;const e=Math.floor((s-3)/2),a=t.slice(0,e),i=t.slice(t.length-e);return a+"..."+i}x(z,function(t,s,e){if(e.has("create")){const a=[];if(e.has("s")){y(t);const[i,m]=t.selection.getRange(),n=w(i,m),l=s.dimension;let r,o,d;n.x>n.y&&n.x>n.z?(r="y",o="z",d="x"):n.z>n.x&&n.z>n.y?(r="x",o="y",d="z"):(r="x",o="z",d="y");for(let c=i[d];c<=m[d];c++){const u=new h;for(let f=i[r];f<=m[r];f++)for(let g=i[o];g<=m[o];g++)u.addBlock(l.getBlock({[r]:f,[o]:g,[d]:c}).permutation);a.push(u)}}else a.push(...e.get("patterns"));return t.createGradient(e.get("id"),e.get("f-fade")??1,a),p.translate("commands.wedit:gradient.create").with(e.get("id"))}else if(e.has("delete")){if(t.getGradientNames().includes(e.get("id")))return t.deleteGradient(e.get("id")),p.translate("commands.wedit:gradient.delete").with(e.get("id"));throw p.translate("commands.wedit:gradient.noExist").with(e.get("id"))}else if(e.has("list")){const a=t.getGradientNames();if(a.length)return a.map(i=>{const n=t.getGradient(i).patterns.map(l=>`"${l.toJSON()}"`).join(", ");return`- ${i} (${b(n,100)})`}).join(`
`)}});
