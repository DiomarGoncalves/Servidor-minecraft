import{PlayerUtil as d}from"server/modules/player_util.js";import{RegionBuffer as f}from"server/modules/region_buffer.js";import{RawText as u,Vector as c}from"library/Minecraft.js";import{world as l}from"@minecraft/server";import{registerCommand as p}from"../register_commands.js";const g={name:"import",permission:"worldedit.structure.import",description:"commands.wedit:import.description",usage:[{name:"name",type:"string"}]};function s(t,o){t.includes(":")||(t="mystructure:"+t);const r=o.dimension;let e=d.getBlockLocation(o);for(;r.getEntitiesAtBlockLocation(e).some(m=>m.typeId=="wedit:struct_meta");)e=e.offset(1,0,0);const i=r.spawnEntity("wedit:struct_meta",e);i.nameTag="__placeholder__",l.structureManager.place(t,o.dimension,e);let a;const n=r.getEntitiesAtBlockLocation(e).find(m=>m.typeId=="wedit:struct_meta"&&m.nameTag!="__placeholder__");return n&&(a=n.nameTag,n.remove()),i.remove(),a}function w(t,o){if(!t.includes(":")){const n=s("weditstructref_"+t,o);n&&(t=n)}const[r,e]=t.split(":");let i;try{i=JSON.parse(s(r+":weditstructmeta_"+e,o))}catch{throw"commands.generic.wedit:commandFail"}return{buffer:f.get(r+":weditstructexport_"+e),metadata:i}}p(g,function(t,o,r){const e=r.get("name"),{buffer:i,metadata:a}=w(e,o);return t.clipboard=i,t.clipboardTransform={offset:c.from(a.relative),rotation:c.ZERO,scale:c.ONE},u.translate("commands.wedit:import.explain").with(r.get("name"))});export{w as importStructure};
