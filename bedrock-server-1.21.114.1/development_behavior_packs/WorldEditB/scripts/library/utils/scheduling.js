import{system as v,world as T}from"@minecraft/server";let o=!1;T.afterEvents.worldLoad.subscribe(()=>o=!0);const n=new Map,r=new Map;let s=0,u=0;function a(t,e=1,...i){const c={callback:t,tick:e,args:i};return s++,n.set(s,c),s}function l(t,e=1,...i){const c={callback:t,tick:e,args:i};return u++,r.set(u,c),u}function w(t){n.delete(t)}function f(t){r.delete(t)}let m=0;v.runInterval(()=>{m++;for(const[t,e]of n)e.tick--,e.tick<=0&&(e.callback(...e.args),n.delete(t));for(const[,t]of r)m%t.tick===0&&t.callback(...t.args)});function d(t){return new Promise(e=>a(e,t))}function b(t){if(o){const e=t();return Promise.resolve(e)}return new Promise(e=>{const i=l(()=>{o&&(e(t()),f(i))})})}function I(t){let e=0;return function(i){e-- >0||(e=t,i())}}function h(){n.clear(),r.clear()}class k{constructor(){this.time=Date.now();this.isActive=!1}start(){this.isActive||(this.time=Date.now(),this.isActive=!0)}getTime(){if(this.isActive)return Date.now()-this.time}end(){if(this.isActive)return this.isActive=!1,Date.now()-this.time}}function p(){const t=new k;return t.start(),t}export{k as Timer,f as clearTickInterval,w as clearTickTimeout,I as everyCall,l as setTickInterval,a as setTickTimeout,h as shutdownTimers,d as sleep,p as startTime,b as whenReady};
