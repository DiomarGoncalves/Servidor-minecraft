import{Server as l}from"library/Minecraft.js";import{copy as g}from"./copy.js";import{set as k}from"../region/set.js";import{registerCommand as w}from"../register_commands.js";import{assertCuboidSelection as b}from"server/modules/assert.js";import{Pattern as f}from"server/modules/pattern.js";import{RawText as u}from"library/Minecraft.js";import{Jobs as h}from"server/modules/jobs.js";const _={name:"cut",permission:"worldedit.clipboard.cut",description:"commands.wedit:cut.description",usage:[{flag:"a"},{flag:"e"},{name:"fill",type:"Pattern",default:new f("air")},{flag:"m",name:"mask",type:"Mask"}]};function*R(e,n,r=new f("air"),m){const i=n.get("_using_item"),t=e.player.dimension,o=i?e.globalMask:n.has("m")?n.get("m-mask"):void 0,a=i?e.includeEntities:n.has("e"),[c,p]=e.selection.getRange();let d;if(d=yield*g(e,n,m)){if(yield*k(e,r,o,!1),a){const s={excludeTypes:["minecraft:player"],location:c,volume:p.sub(c)};for(const y of t.getEntities(s))y.nameTag="wedit:marked_for_deletion";l.runCommand("execute @e[name=wedit:marked_for_deletion] ~~~ tp @s ~ -512 ~",t),l.runCommand("kill @e[name=wedit:marked_for_deletion]",t)}return d}}w(_,function*(e,n,r){b(e);const[m,i]=e.selection.getRange(),t=e.history,o=t.record();return yield*h.run(e,3,function*(){try{if(t.trackSelection(o),yield*t.trackRegion(o,m,i),!(yield*R(e,r,r.get("fill"),!0)))throw u.translate("commands.generic.wedit:commandFail");yield*t.commit(o)}catch(a){throw t.cancel(o),a}}),u.translate("commands.wedit:cut.explain").with(`${e.clipboard.getVolume()}`)});export{R as cut};
