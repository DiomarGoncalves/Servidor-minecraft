import{assertSelection as p}from"server/modules/assert.js";import{Jobs as n}from"server/modules/jobs.js";import{PlayerUtil as a}from"server/modules/player_util.js";import{RawText as m}from"library/Minecraft.js";import{registerCommand as h}from"../register_commands.js";const w={name:"biomeinfo",permission:"worldedit.biome.info",description:"commands.wedit:biomeinfo.description",usage:[{flag:"p"},{flag:"t"}]};h(w,function*(e,t,s){if(s.has("p")){const o=t.dimension.getBiome(a.getBlockLocation(t));return m.translate("commands.wedit:biomeinfo.position").with(o.id)}else if(s.has("t")){const o=a.traceForBlock(t);if(!o)throw"commands.wedit:jumpto.none";const i=t.dimension.getBiome(o);return m.translate("commands.wedit:biomeinfo.lineofsight").with(i.id)}else return p(e),yield*n.run(e,1,function*(){yield n.nextStep("Reading biome data...");const o=t.dimension,i=new Set,r=e.selection.getBlockCount(),d=Math.ceil(1/Math.min(128/r,1));let l=0,c=0;for(const g of e.selection.getBlocks())c%d==0?i.add(o.getBiome(g).id):yield n.setProgress(++l/r),c++;n.setProgress(1);const f=`
`+[...i].join(`,
`);return m.translate("commands.wedit:biomeinfo.selection").with(f)})});
