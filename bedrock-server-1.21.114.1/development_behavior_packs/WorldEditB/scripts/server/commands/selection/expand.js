import{assertCuboidSelection as h}from"server/modules/assert.js";import{Cardinal as a}from"server/modules/directions.js";import{RawText as b}from"library/Minecraft.js";import{Vector as s}from"library/Minecraft.js";import{registerCommand as w}from"../register_commands.js";const C={name:"expand",description:"commands.wedit:expand.description",permission:"worldedit.selection.expand",usage:[{subName:"vert",args:[{name:"height",type:"int",default:384}]},{subName:"_",args:[{name:"amount",type:"int"},{name:"direction",type:"Direction",default:new a(a.Dir.FORWARD)}]},{subName:"_reverse",args:[{name:"amount",type:"int"},{name:"reverseAmount",type:"int"},{name:"direction",type:"Direction",default:new a(a.Dir.FORWARD)}]}]};w(C,function(n,p,e){h(n);const t=n.selection.points.map(g=>s.from(g));let o,i,d,c;e.has("vert")?(o=new s(0,1,0),i=1,d=e.get("height"),c=e.get("height")):(o=e.get("direction").getDirection(p),i=o.x?0:o.y?1:2,d=Math.max(-e.get("amount"),0)+Math.max(e.get("reverseAmount")??0,0),c=Math.max(e.get("amount"),0)+Math.max(-(e.get("reverseAmount")??0),0));let[m,r]=[-1,-1];const[l,u]=[t[0].getIdx(i),t[1].getIdx(i)];o.getIdx(i)>=0?[m,r]=l>u?[1,0]:[0,1]:[m,r]=l<u?[1,0]:[0,1],t[m]=t[m].sub(o.mul(d)),t[r]=t[r].add(o.mul(c));const f=n.selection.getBlockCount();n.selection.clear(),n.selection.set(0,t[0].floor()),n.selection.set(1,t[1].floor());const x=n.selection.getBlockCount();return b.translate("commands.wedit:expand.explain").with(x-f)});
