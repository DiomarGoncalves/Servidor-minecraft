import{Tool as g}from"./base_tool.js";import{Tools as b}from"./tool_manager.js";import{Server as h,regionIterateBlocks as P}from"library/Minecraft.js";import{getWorldHeightLimits as S,locToString as B}from"server/util.js";import d from"config.js";class D extends g{constructor(){super(...arguments);this.noDelay=!0;this.permission="worldedit.superpickaxe";this.hit=this.break}*break(m,u,i){const t=m.dimension,p=t.getBlock(i).typeId;if(p=="minecraft:air")return;const{mode:y,range:a}=u.superPickaxe;if(y=="single"){l(t,i,d.superPickaxeDrop);return}const s=S(t);if(y=="area"){const e=i.sub(a),o=i.add(a);e.y=Math.max(e.y,s[0]),o.y=Math.min(o.y,s[1]);for(const c of P(e,o))t.getBlock(c).typeId==p&&l(t,c,d.superPickaxeManyDrop),yield;return}const x=a*a,f=[i],k=new Set;for(;f.length;){const e=f.shift(),o=B(e);if(!k.has(o)&&i.sub(e).lengthSqr<=x&&e.y>=s[0]&&e.y<=s[1]&&t.getBlock(e).typeId==p){k.add(o),l(t,e,d.superPickaxeManyDrop);for(const c of[[0,1,0],[0,-1,0],[1,0,0],[-1,0,0],[0,0,1],[0,0,-1]])f.push(e.add(c))}yield}}}b.register(D,"superpickaxe",["minecraft:diamond_pickaxe","minecraft:golden_pickaxe","minecraft:iron_pickaxe","minecraft:netherite_pickaxe","minecraft:stone_pickaxe","minecraft:wooden_pickaxe"],function(n,r){return r.superPickaxe.enabled});function l(n,r,m){m?h.runCommand(`setblock ${r.x} ${r.y} ${r.z} air destroy`,n):n.getBlock(r).setType("minecraft:air")}
