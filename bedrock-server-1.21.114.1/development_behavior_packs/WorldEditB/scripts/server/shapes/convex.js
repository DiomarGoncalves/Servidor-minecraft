import{Shape as c}from"./base_shape.js";import{regionBounds as a,Vector as s}from"library/Minecraft.js";import{isPointInsideHull as o,QuickHull as n}from"server/modules/extern/quickhull3d/quickhull.js";import{plotCurve as p}from"server/commands/region/paths_func.js";class b extends c{constructor(e){super();this.curveTick=0;this.curveParticles=[];this.customHollow=!0;this.drawCurve=!1;this.points=e.map(t=>s.from(t)),this.faces=new n(this.points).build().collectFaces(!0),[this.min,this.max]=a(e)}getRegion(e){return[e.add(this.min),e.add(this.max)]}getYRange(){throw new Error("getYRange not implemented!")}getOutline(){const e=[];if(this.drawCurve){const t=Array.from(p(this.points)).filter((i,r)=>r%3===0).map(i=>s.from(i).add(.5));this.curveParticles=this.drawLine(t)}for(const t of this.faces){const i=t.map(r=>this.points[r].add(.5));e.push(...this.drawLine(i,!0))}return e}draw(e,t){const i=this.outlineCache;this.curveTick>3&&this.curveParticles.length&&(this.outlineCache=this.curveParticles),super.draw(e,t),this.curveTick=(this.curveTick+1)%8,this.outlineCache=i??this.outlineCache}prepGeneration(e,t){e.isHollow=t?.hollow??!1,e.thickness=t?.hollowThickness??1}inShape(e,t){return t.isHollow&&!o(e,this.points,this.faces,-1)?!1:o(e,this.points,this.faces)}}export{b as ConvexShape};
